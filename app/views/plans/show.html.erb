<div class="max-w-7xl mx-auto px-4 py-8">
  <%= render "shared/settings_nav" %>

  <div class="bg-base-100 border border-base-300 rounded-2xl p-6 sm:p-8">
    <div class="pb-5 border-b border-base-300 mb-6">
      <h2 class="text-xl font-semibold text-base-content mb-1">Plan & Billing</h2>
      <p class="text-sm text-base-500">Manage your subscription</p>
    </div>

    <div class="space-y-8">
      <div>
        <label class="text-xs font-semibold text-base-500 uppercase tracking-wide">Current Plan</label>
        <p class="text-lg font-semibold text-base-content capitalize mt-2"><%= current_account.plan %></p>
      </div>

      <% if current_account.subscription_started_at.present? %>
        <div>
          <label class="text-xs font-semibold text-base-500 uppercase tracking-wide">Billing Period</label>
          <p class="text-base-content font-medium mt-1">
            <%= current_account.subscription_started_at.strftime("%B %d, %Y") %> -
            <%= current_account.subscription_ends_at&.strftime("%B %d, %Y") || "Ongoing" %>
          </p>
        </div>
      <% end %>

      <div class="pt-6 border-t border-base-300">
        <h3 class="text-sm font-semibold text-base-content mb-4">Available Plans</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <%# Free Plan %>
          <div class="bg-base-100 border border-base-300 rounded-2xl p-6 <%= current_account.free? ? 'ring-2 ring-primary' : '' %>">
            <div class="mb-4">
              <h4 class="text-lg font-semibold text-base-content">Free</h4>
              <p class="text-sm text-base-500 mt-1">For individuals getting started</p>
            </div>
            <div class="mb-6">
              <span class="text-3xl font-semibold text-base-content">$0</span>
              <span class="text-base-500">/month</span>
            </div>
            <ul class="space-y-2 mb-6 text-sm text-base-content">
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Basic features
              </li>
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                1 team member
              </li>
            </ul>
            <% if current_account.free? %>
              <div class="px-4 py-2.5 text-sm font-medium text-center rounded-full bg-base-200 text-base-500">
                Current Plan
              </div>
            <% end %>
          </div>

          <%# Pro Plan %>
          <div class="bg-base-100 border border-base-300 rounded-2xl p-6 <%= current_account.pro? ? 'ring-2 ring-primary' : '' %>">
            <div class="mb-4">
              <h4 class="text-lg font-semibold text-base-content">Pro</h4>
              <p class="text-sm text-base-500 mt-1">For growing teams</p>
            </div>
            <div class="mb-6">
              <span class="text-3xl font-semibold text-base-content">$29</span>
              <span class="text-base-500">/month</span>
            </div>
            <ul class="space-y-2 mb-6 text-sm text-base-content">
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                All Free features
              </li>
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                5 team members
              </li>
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Priority support
              </li>
            </ul>
            <% if current_account.pro? %>
              <div class="px-4 py-2.5 text-sm font-medium text-center rounded-full bg-base-200 text-base-500">
                Current Plan
              </div>
            <% else %>
              <%= button_to "Upgrade to Pro", stripe_checkout_path(price_id: ENV["STRIPE_PRO_PRICE_ID"]),
                  class: "w-full px-4 py-2.5 text-sm font-semibold rounded-full bg-primary text-primary-content border-2 border-primary hover:brightness-90 transition-all cursor-pointer" %>
            <% end %>
          </div>

          <%# Business Plan %>
          <div class="bg-base-100 border border-base-300 rounded-2xl p-6 <%= current_account.business? ? 'ring-2 ring-primary' : '' %>">
            <div class="mb-4">
              <h4 class="text-lg font-semibold text-base-content">Business</h4>
              <p class="text-sm text-base-500 mt-1">For larger organizations</p>
            </div>
            <div class="mb-6">
              <span class="text-3xl font-semibold text-base-content">$99</span>
              <span class="text-base-500">/month</span>
            </div>
            <ul class="space-y-2 mb-6 text-sm text-base-content">
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                All Pro features
              </li>
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Unlimited team members
              </li>
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Dedicated support
              </li>
              <li class="flex items-center gap-2">
                <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Custom integrations
              </li>
            </ul>
            <% if current_account.business? %>
              <div class="px-4 py-2.5 text-sm font-medium text-center rounded-full bg-base-200 text-base-500">
                Current Plan
              </div>
            <% else %>
              <%= button_to "Upgrade to Business", stripe_checkout_path(price_id: ENV["STRIPE_BUSINESS_PRICE_ID"]),
                  class: "w-full px-4 py-2.5 text-sm font-semibold rounded-full bg-primary text-primary-content border-2 border-primary hover:brightness-90 transition-all cursor-pointer" %>
            <% end %>
          </div>
        </div>
      </div>

      <% if current_account.active_subscription? %>
        <div class="pt-6 border-t border-base-300">
          <h3 class="text-sm font-semibold text-error mb-4">Cancel Subscription</h3>
          <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 p-4 bg-base-200 rounded-xl border border-base-300">
            <div>
              <div class="text-base-content font-medium">Cancel Subscription</div>
              <div class="text-sm text-base-500">Your subscription will remain active until the end of the billing period</div>
            </div>
            <%= button_to "Cancel Plan", "#",
                method: :delete,
                class: "px-4 py-2 text-sm font-medium rounded-full text-error hover:bg-error/10 transition-all cursor-pointer w-fit",
                data: { turbo_confirm: "Are you sure you want to cancel your subscription?" } %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
